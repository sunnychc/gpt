<?xml version="1.0" encoding="UTF-8"?>
<svg width="800px" height="500px" viewBox="0 0 800 500" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#000"/>
    </marker>

    <style>
      .node {
        font-family: Arial, sans-serif;
        font-weight: bold;
        text-anchor: middle;
        fill: white;
      }
      .label {
        font-size: 14px;
      }
      .arrow {
        stroke: #111827;
        stroke-width: 2.5;
        marker-end: url(#arrowhead);
      }
    </style>
  </defs>

  <!-- 中心文字 -->
  <circle cx="400" cy="250" r="45" fill="white" stroke="#94A3B8" stroke-width="2"/>
  <text x="400" y="245" font-size="16" text-anchor="middle" fill="#1E293B" font-weight="bold">迭代训练</text>
  <text x="400" y="265" font-size="12" text-anchor="middle" fill="#6B7280">多个 Epoch</text>

  <!-- 训练数据 -->
  <rect x="80" y="200" width="120" height="60" rx="10" fill="#F59E0B"/>
  <text x="140" y="230" class="node label">训练数据</text>
  <text x="140" y="250" font-size="12" fill="white" text-anchor="middle">输入特征 + 标签</text>
  <line x1="200" y1="230" x2="300" y2="150" class="arrow"/>

  <!-- 前向传播 -->
  <circle cx="320" cy="140" r="50" fill="#3B82F6"/>
  <text x="320" y="135" class="node">前向传播</text>
  <text x="320" y="155" class="node label">Forward</text>

  <!-- 损失计算 -->
  <circle cx="480" cy="140" r="50" fill="#EC4899"/>
  <text x="480" y="135" class="node">损失计算</text>
  <text x="480" y="155" class="node label">Loss</text>

  <!-- 反向传播 -->
  <circle cx="480" cy="360" r="50" fill="#8B5CF6"/>
  <text x="480" y="355" class="node">反向传播</text>
  <text x="480" y="375" class="node label">Backward</text>

  <!-- 参数更新 -->
  <circle cx="320" cy="360" r="50" fill="#10B981"/>
  <text x="320" y="355" class="node">参数更新</text>
  <text x="320" y="375" class="node label">Update</text>

  <!-- 收敛判断 -->
  <rect x="600" y="200" width="130" height="60" rx="10" fill="#475569"/>
  <text x="665" y="230" font-size="16" text-anchor="middle" fill="white" font-weight="bold">收敛判断</text>
  <text x="665" y="250" font-size="12" text-anchor="middle" fill="white">损失是否稳定</text>

  <!-- 箭头 -->
  <line x1="370" y1="140" x2="430" y2="140" class="arrow"/>
  <line x1="480" y1="190" x2="480" y2="310" class="arrow"/>
  <line x1="430" y1="360" x2="370" y2="360" class="arrow"/>
  <line x1="320" y1="310" x2="320" y2="190" class="arrow"/>
  <line x1="530" y1="140" x2="600" y2="230" class="arrow"/>

  <!-- 底部文字 -->
  <text x="400" y="490" text-anchor="middle" font-size="14" fill="#475569">
    训练循环持续迭代，直到损失函数收敛或达到预设的迭代次数
  </text>
</svg> 