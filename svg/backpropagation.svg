<?xml version="1.0" encoding="UTF-8"?>
<svg width="800px" height="410px" viewBox="0 0 800 410" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>反向传播过程</title>
    <defs>
        <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="gradientBlue">
            <stop stop-color="#3B82F6" offset="0%"></stop>
            <stop stop-color="#38BDF8" offset="100%"></stop>
        </linearGradient>
        <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="gradientPurple">
            <stop stop-color="#6366F1" offset="0%"></stop>
            <stop stop-color="#8B5CF6" offset="100%"></stop>
        </linearGradient>
        <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="gradientPink">
            <stop stop-color="#D946EF" offset="0%"></stop>
            <stop stop-color="#EC4899" offset="100%"></stop>
        </linearGradient>
        <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.15"/>
        </filter>
        <style>
            /* 默认文本颜色 */
            svg text {
            fill: #000000;
            }

            /* 在暗黑模式下，文字颜色变为白色 */
            @media (prefers-color-scheme: dark) {
            svg text {
            fill: #FFFFFF;
            }
            }
        </style>
    </defs>
    <g id="BackPropagation" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <!-- 输入层节点 -->
        <g id="InputLayer" transform="translate(60, 50)">
            <circle cx="40" cy="50" r="25" fill="url(#gradientBlue)" filter="url(#shadow)"></circle>
            <circle cx="40" cy="150" r="25" fill="url(#gradientBlue)" filter="url(#shadow)"></circle>
            <circle cx="40" cy="250" r="25" fill="url(#gradientBlue)" filter="url(#shadow)"></circle>
            <text x="40" y="55" font-family="Arial" font-size="14" fill="#FFFFFF" text-anchor="middle">x₁</text>
            <text x="40" y="155" font-family="Arial" font-size="14" fill="#FFFFFF" text-anchor="middle">x₂</text>
            <text x="40" y="255" font-family="Arial" font-size="14" fill="#FFFFFF" text-anchor="middle">x₃</text>
        </g>

        <!-- 隐藏层节点 -->
        <g id="HiddenLayer" transform="translate(260, 75)">
            <circle cx="40" cy="50" r="25" fill="url(#gradientPurple)" filter="url(#shadow)"></circle>
            <circle cx="40" cy="175" r="25" fill="url(#gradientPurple)" filter="url(#shadow)"></circle>
            <text x="40" y="55" font-family="Arial" font-size="14" fill="#FFFFFF" text-anchor="middle">h₁</text>
            <text x="40" y="180" font-family="Arial" font-size="14" fill="#FFFFFF" text-anchor="middle">h₂</text>
        </g>

        <!-- 输出层节点 -->
        <g id="OutputLayer" transform="translate(460, 100)">
            <circle cx="40" cy="100" r="25" fill="url(#gradientPink)" filter="url(#shadow)"></circle>
            <text x="40" y="105" font-family="Arial" font-size="14" fill="#FFFFFF" text-anchor="middle">ŷ</text>
        </g>

        <!-- 损失函数 -->
        <g id="LossFunction" transform="translate(610, 100)">
            <circle cx="40" cy="100" r="30" fill="#EF4444" filter="url(#shadow)"></circle>
            <text x="40" y="105" font-family="Arial" font-size="16" fill="#FFFFFF" text-anchor="middle">Loss</text>
        </g>

        <!-- 前向传播连接线 -->
        <!-- 输入层到隐藏层 -->
        <g id="ForwardConnections1" stroke="#3B82F6" stroke-width="2">
            <line x1="125" y1="100" x2="275" y2="125" stroke-linecap="round"></line>
            <line x1="125" y1="100" x2="275" y2="250" stroke-linecap="round"></line>
            <line x1="125" y1="200" x2="275" y2="125" stroke-linecap="round"></line>
            <line x1="125" y1="200" x2="275" y2="250" stroke-linecap="round"></line>
            <line x1="125" y1="300" x2="275" y2="125" stroke-linecap="round"></line>
            <line x1="125" y1="300" x2="275" y2="250" stroke-linecap="round"></line>

            <!-- 箭头 -->
            <polygon points="273,125 265,119 265,131" fill="#3B82F6"></polygon>
            <polygon points="273,250 265,244 265,256" fill="#3B82F6"></polygon>
        </g>

        <!-- 隐藏层到输出层 -->
        <g id="ForwardConnections2" stroke="#6366F1" stroke-width="2">
            <line x1="325" y1="125" x2="475" y2="200" stroke-linecap="round"></line>
            <line x1="325" y1="250" x2="475" y2="200" stroke-linecap="round"></line>

            <!-- 箭头 -->
            <polygon points="473,200 465,194 465,206" fill="#6366F1"></polygon>
        </g>

        <!-- 输出到损失 -->
        <g id="ForwardConnections3" stroke="#D946EF" stroke-width="2">
            <line x1="525" y1="200" x2="625" y2="200" stroke-linecap="round"></line>

            <!-- 箭头 -->
            <polygon points="623,200 615,194 615,206" fill="#D946EF"></polygon>
        </g>

        <!-- 反向传播连接线 (虚线) -->
        <!-- 损失到输出层 -->
        <g id="BackwardConnections1" stroke="#EF4444" stroke-width="2" stroke-dasharray="6,3">
            <line x1="625" y1="210" x2="525" y2="210" stroke-linecap="round"></line>

            <!-- 箭头 -->
            <polygon points="527,210 535,204 535,216" fill="#EF4444"></polygon>
        </g>

        <!-- 输出层到隐藏层 -->
        <g id="BackwardConnections2" stroke="#EF4444" stroke-width="2" stroke-dasharray="6,3">
            <line x1="475" y1="210" x2="325" y2="135" stroke-linecap="round"></line>
            <line x1="475" y1="210" x2="325" y2="260" stroke-linecap="round"></line>

            <!-- 箭头 -->
            <polygon points="327,135 335,129 335,141" fill="#EF4444"></polygon>
            <polygon points="327,260 335,254 335,266" fill="#EF4444"></polygon>
        </g>

        <!-- 隐藏层到输入层 -->
        <g id="BackwardConnections3" stroke="#EF4444" stroke-width="2" stroke-dasharray="6,3">
            <line x1="275" y1="135" x2="125" y2="110" stroke-linecap="round"></line>
            <line x1="275" y1="135" x2="125" y2="210" stroke-linecap="round"></line>
            <line x1="275" y1="135" x2="125" y2="310" stroke-linecap="round"></line>
            <line x1="275" y1="260" x2="125" y2="110" stroke-linecap="round"></line>
            <line x1="275" y1="260" x2="125" y2="210" stroke-linecap="round"></line>
            <line x1="275" y1="260" x2="125" y2="310" stroke-linecap="round"></line>

            <!-- 箭头 -->
            <polygon points="127,110 135,104 135,116" fill="#EF4444"></polygon>
            <polygon points="127,210 135,204 135,216" fill="#EF4444"></polygon>
            <polygon points="127,310 135,304 135,316" fill="#EF4444"></polygon>
        </g>

        <!-- 标签 -->
        <g id="Labels" font-family="Arial" font-size="14">
            <text x="60" y="30" font-weight="bold" class="label">输入层</text>
            <text x="260" y="30" font-weight="bold" class="label">隐藏层</text>
            <text x="460" y="30" font-weight="bold" class="label">输出层</text>
            <text x="610" y="30" font-weight="bold" class="label">损失函数</text>

            <!-- 权重标签 -->
            <text x="200" y="70" font-size="12" class="label">w₁₁</text>
            <text x="200" y="130" font-size="12" class="label">w₁₂</text>
            <text x="200" y="190" font-size="12" class="label">w₂₁</text>
            <text x="200" y="250" font-size="12" class="label">w₂₂</text>
            <text x="200" y="300" font-size="12" class="label">w₃₁</text>
            <text x="200" y="360" font-size="12" class="label">w₃₂</text>

            <text x="400" y="150" font-size="12" class="label">v₁</text>
            <text x="400" y="250" font-size="12" class="label">v₂</text>

            <!-- 梯度标签 -->
            <text x="590" y="235" font-size="12" class="gradient-label">∂L/∂ŷ</text>
            <text x="400" y="130" font-size="12" class="gradient-label">∂L/∂v₁</text>
            <text x="400" y="270" font-size="12" class="gradient-label">∂L/∂v₂</text>
            <text x="200" y="90" font-size="12" class="gradient-label">∂L/∂w₁₁</text>
            <text x="200" y="150" font-size="12" class="gradient-label">∂L/∂w₁₂</text>
        </g>
    </g>
</svg>
